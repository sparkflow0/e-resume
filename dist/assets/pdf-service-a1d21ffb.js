const l=window.pdfjsLib,m=async w=>{if(!l)throw new Error("PDF.js library not loaded");const p=await w.arrayBuffer();try{const s=await l.getDocument({data:p}).promise;let d="",g;for(let e=1;e<=s.numPages;e++){const a=(await(await s.getPage(e)).getTextContent()).items.map(o=>o.str).join(" ");d+=a+`
`}const h=await s.getPage(1),i=await h.getOperatorList();console.log("Page 1 Ops:",i.fnArray.length);let f=0,t=null;for(let e=0;e<i.fnArray.length;e++)if(i.fnArray[e]===l.OPS.paintImageXObject){const n=i.argsArray[e][0];await new Promise(r=>{h.objs.get(n,a=>{if(console.log("Found Image Object:",n,a),a&&a.width&&a.height){const o=a.width*a.height;console.log(`Image ${n} area: ${o} (w=${a.width}, h=${a.height})`),o>5e3&&o>f&&(console.log("--> New Candidate for Profile Pic!"),f=o,t=a)}r()})})}if(t){const e=document.createElement("canvas");e.width=t.width,e.height=t.height;const n=e.getContext("2d");if(n){if(t.bitmap)console.log("Drawing ImageBitmap..."),n.drawImage(t.bitmap,0,0);else if(t.data){console.log("Drawing ImageData...");const r=n.createImageData(t.width,t.height);if(t.data.length===t.width*t.height*3){let a=0;for(let o=0;o<t.data.length;o+=3)r.data[a]=t.data[o],r.data[a+1]=t.data[o+1],r.data[a+2]=t.data[o+2],r.data[a+3]=255,a+=4;n.putImageData(r,0,0)}else t.data.length===t.width*t.height*4&&(r.data.set(t.data),n.putImageData(r,0,0))}g=e.toDataURL(),console.log("Profile Image extracted successfully!",g.substring(0,50)+"...")}}return{text:d,profileImage:g}}catch(c){throw console.error("Error parsing PDF:",c),new Error("Failed to parse PDF file.")}};export{m as extractTextAndImage};
